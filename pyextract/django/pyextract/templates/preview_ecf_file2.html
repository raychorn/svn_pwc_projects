{% extends 'base.html' %}

{% block css %}
{% endblock %}

{% block js_document_ready %}
		var __isfile__ = "{{ isfile }}".toLowerCase() == 'true' ? true : false;
		console.log('(3)' + __isfile__ + ', typeof --> ' + typeof(__isfile__));
		if (__isfile__) {
			$( "#dialog" ).dialog();
		}
{% endblock %}

{% block main-content %}
   <table width="100%" border="0" bordercolor="#000000">
	   <tr>
		   <td width="85%" valign="top">
			   <table width="100%" border="0" bordercolor="#000000">
				   <tr>
					   <td width="50px">
						   <b><nobr>Select ECF File:</nobr></b>
					   </td>
					   <td width="*">
							<div class="input_wrap">
							   <input class="autowidthinput" type="text" name="ecf_file" value="{{ ecf_file }}" maxlength="128">
							</div>
					   </td>
					   <td width="50px">
						   <a class="ui-button ui-widget ui-corner-all" href="/preview_ecf_file2?top={{ ecf_file_dirname }}">Browse</a>
					   </td>
				   </tr>

{% if isfile %}
				   <tr>
					   <td valign="top" colspan="3">
						   <div class="outer">{% autoescape off %}{{ the_ecftext }}{% endautoescape %}</div>
							<div id="dialog" title="ERROR">
							  <p>The file "{{ ecf_file }}" could not be decrypted. Make sure you 
                        		selected a valid v2.0 ".ecf" file generated by the PwC 
                        		ECF Generation service.</p>
							</div>

					   </td>
				   </tr>
{% else %}
				   <tr>
					   <td valign="top" colspan="3">
						   <div id="div_file_chooer">{% autoescape off %}{{ the_file_chooser }}{% endautoescape %}</div>
					   </td>
				   </tr>
{% endif %}
				   <tr>
					   <td>
						   <table width="100%">
							   <tr>
								   <td align="left">
									   <a class="ui-button ui-widget ui-corner-all" href="{{ cancel_link }}">Cancel</a>
									   &nbsp;&nbsp;
								   </td>
								   <td align="left">
{% if isfile2 %}
									   <a class="ui-button ui-widget ui-corner-all" href="/handle_connection?ecffile={{ ecf_file }}">Continue</a>
									   &nbsp;&nbsp;
{% endif %}
								   </td>
							   </tr>
							</table>
						</td>
				   </tr>
			   </table>
		   </td>
		   <td valign="top">
			   <div class="outer">{% autoescape off %}{{ the_helptext }}{% endautoescape %}</div>
		   </td>
	   </tr>
	</table>
{% endblock %}

